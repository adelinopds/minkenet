<div class="capture">
  {{#unless topologyValid}}
  {{> NetworkTopologyNotice}}
  {{/unless}}
  <div class="capture-config-container">
    <div class="capture-config">
      <div class="form-group">
        Capture packets where
        <select id="capture-host-type">
          <option value="SD" >Source or Destination IP</option>
          <option value="S" >Source IP</option>
          <option value="D">Destination IP</option>
        </select>
        <span>equals</span>
        <span style="white-space: nowrap;"><input id="capture-host" type="text" placeholder="any" size="15">,</span>
        <span>Protocol equals</span>
        <span style="white-space: nowrap;"><select id="capture-protocol">
          <option value="">Any</option>
          <option>TCP</option>
          <option>UDP</option>
          <option>ARP</option>
        </select>,</span>
        <select id="capture-port-type">
          <option value="SD" >Source or Destination Port</option>
          <option value="S" >Source Port</option>
          <option value="D">Destination Port</option>
        </select>
        <input id="capture-port" type="text" placeholder="any" size="5">
        <span>and</span>
        <div class="dropdown" style="display: inline-block">
          <button class="dropdown-toggle" style="line-height: 1" type="button" data-toggle="dropdown">
            Options
          </button>
          <div id="capture-options" class="dropdown-menu">
            <form class="px-4 pt-2" style="width:275px;font-size:12px">
              <div class="form-group">
                <div class="form-check">
                  <input id="capture-o-broadcast" class="form-check-input" type="checkbox" checked><label class="form-check-label">Ignore broadcast packets</label>
                </div>
                <div class="form-check">
                  <input id="capture-o-multicast" class="form-check-input" type="checkbox" checked><label class="form-check-label">Ignore multicast packets</label>
                </div>
                <div class="form-check">
                  <input id="capture-o-host" class="form-check-input" type="checkbox" checked><label class="form-check-label">Ignore packets to or from me</label>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <div style="position: relative; width: 70px;">
      <button id="capture-start" type="button" class="capture-start btn btn-secondary btn-sm" onclick="startCapture()">Start</button>
    </div>
  </div>
  <div class="capture-window">
    <div class="capture-window-content" id="capture-window-content">
      <div class="capture-window-title packet">
        <div class="time">Time</div><div class="source">Source</div><div class="destination">Destination</div><div class="protocol">Protocol</div><div class="info">Information</div>
      </div>
    </div>
  </div>
  <script>
    window.startCapture = function() {
      const button = document.getElementById('capture-start');
      if (button.innerText === 'Start') {
        const config = {
          hostType: document.getElementById('capture-host-type').value,
          host: document.getElementById('capture-host').value,
          proto: document.getElementById('capture-protocol').value,
          portType: document.getElementById('capture-port-type').value,
          port: document.getElementById('capture-port').value,
          options: {
            ignoreBroadcast: document.getElementById('capture-o-broadcast').checked,
            ignoreMulticast: document.getElementById('capture-o-multicast').checked,
            ignoreHost: document.getElementById('capture-o-host').checked
          }
        };
        $('#capture-network-update').modal('show');
        send('capture.start', config);
        button.innerText = 'Stop';
      }
      else {
        send('capture.stop');
        button.innerText = 'Start';
      }
    }
  </script>
</div>
{{> CaptureUModal }}
